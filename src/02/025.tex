\section{Conjugate Functions}
\label{sect:025}

\paragraph{}Fix a scalar function $f$ on $\mathbb{R}^m$ for this section. We can consider its conjugate functions. For a possible explanation of the motivation of this definition, one can look at the example following \Cref{defn:025-indicator-function}, which shows how polar cones, subgradients arises from conjugate transforms.

\begin{defn}[Conjugate]\label{defn:025-conjugate}
	The conjugate $f^\star$ is defined as $f^\star(y)=\underset{x\in \mathbb{R}^m}{\operatorname{sup}}x^Ty-f(x)$. Equivalently:
	\[
		f^\star(y)=\inf\left\{b\in \mathbb{R}:x^Ty-f(x)\leq b,\;\text{for all }x\in \mathbb{R}^m\right\} =\inf\left\{b\in \mathbb{R}:\operatorname{epi}(f)\subset E_{(y,-1),b,-}\right\}
	\]
	which describes $f^\star(y)$ geometrically via $\operatorname{epi}(f)$ and extremal halfspace with fixed direction containing it.
	Note that $f^\star$ being the pointwise-supremum of a family of affine functions, $f^\star$ is convex and closed.
\end{defn}

\begin{prop}[Conjugacy Theorem]\label{prop:025-conjugacy-theorem}.
	\begin{enumerate}[label=(\alph*)]
		\item (Dominance) $f$ dominates $f^{\star\star}$.
		\item (Properness) Suppose $f$ is convex, then properness of any of $f,f^{\star},f^{\star\star}$ implies that of others.
		\item (Conjugate Equality) We have $f^\star=(\operatorname{clconv}f)^\star$.
		\item (Double Conjugate Equality) If $\operatorname{clconv}(f)$ is proper, then $f^{\star\star}=\operatorname{clconv}(f)$.
	\end{enumerate}
\end{prop}

\begin{proof}
	For (a), we have $f^{\star\star}(x)=\sup_y\left(x^Ty-f^\star(y)\right)\leq \sup_y \left(x^Ty-\left(x^Ty-f(x)\right)\right)=f(x)$.\\
	For (c), use the geometric description along with the fact that closed halfspaces are convex.\\
	For (b), we show $f$ proper iff $f^\star$ proper (under the assumption $f$ convex), which would suffice.
	\begin{itemize}
		\item "$f$ improper implies $f^\star$ improper": If $f(\mathbb{R}^m)=\{+\infty\}$, then $f^\star(\mathbb{R}^m)=\{-\infty\}$; if $-\infty\in f(\mathbb{R}^m)$, then $f^\star(\mathbb{R}^m)=\{+\infty\}$.
		\item "$f$ proper implies $f^\star$ proper": Suppose $f$ is proper and convex. By (f) of \Cref{prop:015-hyperplane-sep}, $\operatorname{epi}(f)$ is contained in some $E_{(y_0,-1),b}$ with $y_0\in \mathbb{R}^{m}\smallsetminus \{0\}$, $b\in \mathbb{R}$, therefore $f^\star(y_0)<+\infty$. Now since $f$ is proper, $f(x_0)<+\infty$ for some $x_0\in \mathbb{R}^m$, so for any $y\in \mathbb{R}^m$, $f^\star(y)\geq x_0^Ty-f(x_0)>-\infty$.
	\end{itemize}
	For (d), by (a) and (c), it suffices to show: for convex, closed, proper $f$, $f$ dominates $f^{\star\star}$. Otherwise, say $f(x_0)>f^{\star\star}(x_0)$ for some $x_0$, by (g) of \Cref{prop:015-hyperplane-sep}, we can find $y_0\in \mathbb{R}^m\smallsetminus\{0\}$, $b\in \mathbb{R}$ such that:
	\[
		\left(x_0,f^{\star\star}(x_0)\right)\in E^{o}_{(y_0,-1),b,+}, \; \operatorname{epi}(f)\subset E^o_{(y_0,-1),b,-}
	\]
	This gives:
	\[
		y_0^Tx-f(x)<b<y_0^Tx_0-f^{\star\star}(x_0),\text{ for }x\in \mathbb{R}^m
	\]
	The sup of the leftmost term over $x$ is $f^\star(y_0)$, giving $f^{\star\star}(x_0)<y_0^Tx_0-f^\star(x_0)$, a contradiction.
\end{proof}

\paragraph{}Part (d) of \Cref{prop:025-conjugacy-theorem} gives the following cool intersection theorem (which can be thought of as an extension of \Cref{coro:015-halfspaces-intersection}):

\begin{coro}[Epigraphs as Intersections]\label{coro:025-epigraph-conjugacy-intersection}
	Suppose $f$ is scalar function with $\operatorname{clconv}(f)$ proper. We have:
	\[
		\operatorname{epi}(\operatorname{clconv}(f)) = \bigcap_{y\in \mathbb{R}^m}E_{(y,-1),f^\star(y), -}
	\]
	Note that "$\subset$" always holds, by the definition of conjugate functions.
\end{coro}

\begin{proof}
	When $\operatorname{clconv}(f)$ is proper, (d) of \Cref{prop:025-conjugacy-theorem} gives:
	\begin{align*}
		\operatorname{epi}(\operatorname{clconv}(f)) =\operatorname{epi}(f^{\star\star}) & =\left\{
		(x,u)\in \mathbb{R}^{m+1}:\sup_{y\in \mathbb{R}^m} \left(y^Tx-f^\star(y)\right)\leq u
		\right\}                                                                                                                                         \\
		                                                                                 & =\left\{
		(x,u)\in \mathbb{R}^{m+1}:\sup_{y\in \mathbb{R}^m} \left(y^Tx-u\right)\leq f^\star(y)
		\right\}                                                                                                                                         \\
		                                                                                 & =\bigcap_{y\in \mathbb{R}^m}E_{(y,-1),f^\star(y),-}\qedhere{}
	\end{align*}
\end{proof}

\paragraph{}To end this section, we introduce the "support function" construction.

\begin{defn}[Indicator Function, Support Functions]\label{defn:025-indicator-function}
	Given $X\subset \mathbb{R}^m$, define $\delta_X$ to be a scalar function on $X$ with $\delta_X(x)=0$ for $x\in X$, otherwise $\infty$. The support function of $X$ is defined to be $\sigma_X:=\delta_X^{\star}$. Explicitly, we have $\sigma_X(y)=\sup y^TX$.
\end{defn}

\begin{exmp}We can realize some previously introduced constructions in the language of conjugate transforms:
	\begin{itemize}
		\item (Polar Cone) Suppose $X$ is a convex cone, then $\sigma_X=\delta_{X^\ast}$, as $y^TX\subset \mathbb{R}$ is a cone for any $y\in \mathbb{R}^m$.
		\item (Subgradients as Supports) Suppose $f$ is a convex function on $\mathbb{R}^m$ with $\operatorname{dom}(f)=X$. We have:
		      \[
			      f'(x;-)^\star(y) = \sup \{y^Td - f'(x; d):d\in \mathbb{R}^m\}
		      \]
		      Note that the set on the right is a cone, therefore:
		      \[
			      f'(x;-)^\star(y) = \begin{cases}
				      0      & \text{ if }y^Td \leq f'(x;d)\text{ for all }d\in \mathbb{R}^m;\text{ equivalently: }y\in\partial f(x) \\
				      \infty & \text{ otherwise}
			      \end{cases}
		      \]
		      \begin{itemize}
			      \item In other words: $f'(x;-)^\star = \delta_{\partial f(x)}$.
			      \item We will see that by \Cref{prop:046-set-of-subgrad}, for $x\in \operatorname{ri}(X)$, $\partial f(x)\neq\emptyset$, so (d) of \Cref{prop:025-conjugacy-theorem} gives $\sigma_{\partial f(x)}=\operatorname{cl}(f'(x;-))$.
			      \item Also, when $x\in \operatorname{ri}(X)$, then $f'(x;-)$ is closed, giving $\sigma_{\partial f(x)}=f'(x;-)$. The idea is to use (c) of \Cref{prop:023-compare-func-closure}, and note that $\operatorname{dom}(f'(x;-))=\operatorname{aff}(X)-x$ in this case, which is affine.
		      \end{itemize}
	\end{itemize}
\end{exmp}

\paragraph{}More relations between conjugates and subgradients are established in \Cref{sect:046}.

